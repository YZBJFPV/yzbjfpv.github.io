<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>万食赞 - 工位001</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
  
  <!-- 配置Tailwind自定义主题 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#E67E22',
            secondary: '#3498DB',
            accent: '#9B59B6',
            neutral: '#F5F5F5',
            dark: '#2C3E50'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow {
        text-shadow: 0 2px 8px rgba(0,0,0,0.15);
      }
      .card-hover {
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      .card-hover:hover {
        transform: translateY(-8px);
        box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.05);
      }
      .keyboard-key {
        transition: all 0.15s ease;
      }
      .keyboard-key:active {
        transform: scale(0.95);
        background-color: rgba(230, 126, 34, 0.2);
      }
      .joystick-btn {
        transition: all 0.15s ease;
      }
      .joystick-btn:active {
        transform: scale(0.9);
        background-color: rgba(230, 126, 34, 0.3);
      }
      .module-drag {
        cursor: pointer;
      }
      .module-selected {
        outline: 2px solid #E67E22;
        box-shadow: 0 0 0 4px rgba(230, 126, 34, 0.2);
      }
      .floating {
        animation: floating 6s ease-in-out infinite;
      }
      .float-slow {
        animation: floating 10s ease-in-out infinite;
      }
      .float-fast {
        animation: floating 4s ease-in-out infinite;
      }
      .pinyin-candidate {
        background: white;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 5px;
        margin-top: 5px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      }
      .pinyin-candidate span {
        display: inline-block;
        padding: 2px 8px;
        margin: 0 2px;
        cursor: pointer;
      }
      .pinyin-candidate span:hover, .pinyin-candidate span.active {
        background: #E67E22;
        color: white;
        border-radius: 3px;
      }
    }
    
    @keyframes floating {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-15px); }
      100% { transform: translateY(0px); }
    }
  </style>
</head>
<body class="min-h-screen overflow-hidden relative transition-all duration-10000" id="dynamic-bg">
  <!-- 动态背景装饰容器 -->
  <div id="dynamic-background" class="fixed inset-0 overflow-hidden pointer-events-none z-0"></div>

  <!-- 功能模块容器 -->
  <div id="modules-container" class="absolute inset-0 p-6 z-10">
    <!-- 模块将通过JS动态添加 -->
  </div>

  <!-- 添加模块按钮 -->
  <button id="add-module-btn" class="fixed top-6 right-6 w-12 h-12 bg-primary text-white rounded-full shadow-lg flex items-center justify-center z-50 hover:bg-primary/90 transition-all">
    <span>+</span>
  </button>

  <!-- 模块选择菜单 -->
  <div id="module-menu" class="fixed top-20 right-6 w-48 bg-white rounded-lg shadow-xl z-50 hidden">
    <div class="py-2">
      <button data-module="clock" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition flex items-center">
        <span class="mr-2">⌚</span> 时钟日期
      </button>
      <button data-module="tasks" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition flex items-center">
        <span class="mr-2">✓</span> 今日待办
      </button>
      <button data-module="weather" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition flex items-center">
        <span class="mr-2">☁</span> 天气信息
      </button>
      <button data-module="notes" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition flex items-center">
        <span class="mr-2">📝</span> 便签
      </button>
      <button data-module="calculator" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition flex items-center">
        <span class="mr-2">🧮</span> 计算器
      </button>
    </div>
  </div>

  <!-- 虚拟键盘 -->
  <div id="virtual-keyboard" class="fixed bottom-6 left-50% margin-left-negative-1/2 transform -translate-x-1/2 bg-white/95 backdrop-blur-sm rounded-xl shadow-2xl p-4 w-[90%] max-w-2xl z-40 hidden">
    <!-- 拼音候选区 -->
    <div id="pinyin-candidates" class="pinyin-candidate hidden mb-3"></div>
    
    <!-- 键盘标题栏 -->
    <div class="flex justify-between items-center mb-3">
      <span class="text-gray-600 font-medium">虚拟键盘</span>
      <button id="close-keyboard" class="text-gray-400 hover:text-gray-600 p-1">
        <span>×</span>
      </button>
    </div>
    
    <!-- 键盘切换 -->
    <div class="flex justify-center mb-2">
      <button id="switch-keyboard" class="px-3 py-1 bg-gray-100 rounded-md text-sm">
        中/英
      </button>
    </div>
    
    <!-- 键盘按键区域 -->
    <div class="grid grid-cols-10 gap-2 mb-2">
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="q">q</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="w">w</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="e">e</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="r">r</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="t">t</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="y">y</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="u">u</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="i">i</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="o">o</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="p">p</div>
    </div>
    
    <div class="grid grid-cols-10 gap-2 mb-2">
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="a">a</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="s">s</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="d">d</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="f">f</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="g">g</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="h">h</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="j">j</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="k">k</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="l">l</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="del">
        <span>←</span>
      </div>
    </div>
    
    <div class="grid grid-cols-10 gap-2">
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="shift">
        <span>⇧</span>
      </div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="z">z</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="x">x</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="c">c</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="v">v</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="b">b</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="n">n</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="m">m</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="space">空格</div>
      <div class="keyboard-key col-span-1 bg-primary/10 text-primary rounded-md p-2 text-center" data-key="enter">
        <span>↵</span>
      </div>
    </div>
    
    <!-- 数字和符号切换 -->
    <div class="grid grid-cols-12 gap-2 mt-2">
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="1">1</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="2">2</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="3">3</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="4">4</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="5">5</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="6">6</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="7">7</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="8">8</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="9">9</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key="0">0</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key=",">，</div>
      <div class="keyboard-key col-span-1 bg-gray-100 rounded-md p-2 text-center" data-key=".">。</div>
    </div>
  </div>

  <!-- 方向摇杆控制器（带大小调整） -->
  <div id="joystick" class="fixed bottom-6 right-6 bg-white/95 backdrop-blur-sm rounded-xl shadow-2xl p-3 z-50 w-48 h-48 flex flex-col items-center justify-center">
    <div class="text-xs text-gray-500 mb-1">模块控制器</div>
    <div class="grid grid-cols-4 grid-rows-4 gap-1 w-full h-full">
      <!-- 上 -->
      <div class="col-start-2 row-start-1 col-span-2">
        <button class="joystick-btn w-full h-full bg-gray-100 rounded-md flex items-center justify-center" data-direction="up">
          <span>↑</span>
        </button>
      </div>
      <!-- 下 -->
      <div class="col-start-2 row-start-4 col-span-2">
        <button class="joystick-btn w-full h-full bg-gray-100 rounded-md flex items-center justify-center" data-direction="down">
          <span>↓</span>
        </button>
      </div>
      <!-- 左 -->
      <div class="col-start-1 row-start-2 row-span-2">
        <button class="joystick-btn w-full h-full bg-gray-100 rounded-md flex items-center justify-center" data-direction="left">
          <span>←</span>
        </button>
      </div>
      <!-- 右 -->
      <div class="col-start-4 row-start-2 row-span-2">
        <button class="joystick-btn w-full h-full bg-gray-100 rounded-md flex items-center justify-center" data-direction="right">
          <span>→</span>
        </button>
      </div>
      <!-- 左上 -->
      <div class="col-start-1 row-start-1">
        <button class="joystick-btn w-full h-full bg-gray-100 rounded-md flex items-center justify-center" data-direction="up-left">
          <span>↖</span>
        </button>
      </div>
      <!-- 右上 -->
      <div class="col-start-4 row-start-1">
        <button class="joystick-btn w-full h-full bg-gray-100 rounded-md flex items-center justify-center" data-direction="up-right">
          <span>↗</span>
        </button>
      </div>
      <!-- 左下 -->
      <div class="col-start-1 row-start-4">
        <button class="joystick-btn w-full h-full bg-gray-100 rounded-md flex items-center justify-center" data-direction="down-left">
          <span>↙</span>
        </button>
      </div>
      <!-- 右下 -->
      <div class="col-start-4 row-start-4">
        <button class="joystick-btn w-full h-full bg-gray-100 rounded-md flex items-center justify-center" data-direction="down-right">
          <span>↘</span>
        </button>
      </div>
      <!-- 放大 -->
      <div class="col-start-2 row-start-2">
        <button class="joystick-btn w-full h-full bg-blue-100 text-blue-500 rounded-md flex items-center justify-center" data-action="zoom-in">
          <span>+</span>
        </button>
      </div>
      <!-- 缩小 -->
      <div class="col-start-3 row-start-2">
        <button class="joystick-btn w-full h-full bg-blue-100 text-blue-500 rounded-md flex items-center justify-center" data-action="zoom-out">
          <span>-</span>
        </button>
      </div>
      <!-- 文字放大 -->
      <div class="col-start-2 row-start-3">
        <button class="joystick-btn w-full h-full bg-green-100 text-green-500 rounded-md flex items-center justify-center" data-action="text-in">
          <span>A+</span>
        </button>
      </div>
      <!-- 文字缩小 -->
      <div class="col-start-3 row-start-3">
        <button class="joystick-btn w-full h-full bg-green-100 text-green-500 rounded-md flex items-center justify-center" data-action="text-out">
          <span>A-</span>
        </button>
      </div>
    </div>
  </div>

  <!-- 品牌信息 -->
  <div class="fixed bottom-6 left-6 z-20">
    <div class="flex items-center space-x-3">
      <div class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center shadow-lg">
        <span class="text-white text-xl">餐</span>
      </div>
      <div>
        <h1 class="text-lg font-bold text-dark text-shadow">万食赞</h1>
        <p class="text-gray-500 text-xs">工位 001</p>
      </div>
    </div>
  </div>

  <script>
    // 当前激活的输入框
    var activeInput = null;
    // 键盘大小写状态
    var isShiftActive = false;
    // 输入法状态：chinese/english
    var inputMethod = 'chinese';
    // 当前拼音
    var currentPinyin = '';
    // 模块ID计数器
    var moduleIdCounter = 0;
    // 已添加的模块
    var addedModules = [];
    // 当前选中的模块
    var selectedModule = null;
    // 背景粒子
    var particles = [];
    var particleCount = 20;
    
    // 完整拼音字典
    var pinyinDict = {
      'a': ['啊', '阿', '吖', '呵', '嗄', '腌', '锕'],
      'ai': ['爱', '唉', '矮', '艾', '碍', '哀', '癌', '蔼', '霭', '挨', '皑', '唉', '隘'],
      'an': ['安', '按', '暗', '岸', '庵', '鞍', '氨', '俺', '铵', '揞', '黯', '谙', '埯'],
      'ang': ['昂', '盎', '肮'],
      'ao': ['奥', '熬', '凹', '傲', '袄', '翱', '坳', '敖', '嗷', '鏖', '螯', '獒', '聱'],
      'ba': ['吧', '把', '爸', '罢', '霸', '芭', '拔', '跋', '靶', '耙', '坝', '笆', '鲅'],
      'bai': ['白', '百', '摆', '败', '柏', '拜', '佰', '稗', '捭', '掰'],
      'ban': ['班', '办', '半', '搬', '板', '伴', '斑', '拌', '瓣', '阪', '坂', '钣', '舨'],
      'bang': ['帮', '绑', '棒', '磅', '蚌', '傍', '镑', '浜', '梆', '蒡'],
      'bao': ['包', '宝', '饱', '报', '抱', '暴', '爆', '苞', '胞', '剥', '薄', '堡', '煲'],
      'bei': ['被', '杯', '北', '备', '贝', '背', '悲', '辈', '碑', '卑', '惫', '焙', '蓓'],
      'ben': ['本', '奔', '笨', '贲', '锛', '苯', '畚'],
      'beng': ['蹦', '崩', '泵', '甭', '迸', '绷', '蚌', '嘣', '甏'],
      'bi': ['比', '必', '笔', '壁', '闭', '逼', '鼻', '碧', '弊', '毕', '毙', '庇', '痹'],
      'bian': ['边', '变', '便', '遍', '编', '辩', '辨', '鞭', '贬', '扁', '汴', '苄', '忭'],
      'biao': ['表', '标', '飙', '镖', '膘', '裱', '骠', '镳', '飙'],
      'bie': ['别', '憋', '瘪', '鳖', '别', '蹩'],
      'bin': ['宾', '斌', '滨', '彬', '濒', '殡', '鬓', '缤', '玢', '髌'],
      'bing': ['冰', '兵', '并', '饼', '病', '柄', '丙', '禀', '摒', '邴', '槟'],
      'bo': ['不', '波', '播', '博', '泊', '薄', '伯', '驳', '勃', '搏', '膊', '帛', '菠'],
      'bu': ['不', '布', '步', '部', '补', '捕', '堡', '卜', '哺', '簿', '埠', '埔', '钸'],
      'ca': ['擦', '嚓', '礤'],
      'cai': ['才', '菜', '采', '彩', '财', '裁', '蔡', '材', '睬', '踩', '钗'],
      'can': ['参', '残', '蚕', '惨', '灿', '惭', '孱', '璨', '粲'],
      'cang': ['藏', '仓', '苍', '沧', '舱', '伧'],
      'cao': ['草', '操', '曹', '槽', '糙', '嘈', '漕', '螬'],
      'ce': ['测', '策', '侧', '册', '厕', '恻', '岑'],
      'ceng': ['层', '曾', '蹭', '噌'],
      'cha': ['查', '插', '叉', '茶', '差', '刹', '察', '岔', '诧', '衩', '碴', '搽'],
      'chai': ['柴', '拆', '豺', '钗'],
      'chan': ['产', '颤', '缠', '蝉', '馋', '潺', '婵', '禅', '铲', '蟾', '蒇', '忏'],
      'chang': ['长', '常', '场', '昌', '偿', '肠', '倡', '唱', '畅', '怅', '菖', '猖'],
      'chao': ['超', '潮', '吵', '炒', '巢', '嘲', '焯', '晁', '耖'],
      'che': ['车', '扯', '撤', '掣', '澈', '坼', '砗'],
      'chen': ['陈', '晨', '沉', '尘', '辰', '臣', '趁', '衬', '称', '宸', '谌', '嗔'],
      'cheng': ['成', '城', '称', '程', '乘', '承', '诚', '盛', '呈', '惩', '橙', '骋'],
      'chi': ['吃', '迟', '持', '池', '赤', '尺', '齿', '斥', '痴', '驰', '耻', '翅', '侈'],
      'chong': ['重', '冲', '充', '虫', '崇', '宠', '忡', '憧', '铳'],
      'chou': ['抽', '丑', '臭', '筹', '酬', '愁', '绸', '瞅', '仇', '惆', '踌'],
      'chu': ['出', '处', '除', '初', '楚', '础', '储', '触', '厨', '畜', '锄', '雏'],
      'chuan': ['传', '穿', '船', '川', '串', '喘', '椽', '舛', '钏'],
      'chuang': ['创', '窗', '床', '闯', '疮', '怆'],
      'chui': ['吹', '垂', '锤', '炊', '捶', '陲', '槌'],
      'chun': ['春', '纯', '唇', '醇', '蠢', '淳', '鹑', '莼'],
      'chuo': ['绰', '戳', '啜', '龊'],
      'ci': ['次', '此', '词', '刺', '磁', '慈', '瓷', '茨', '疵', '赐', '雌'],
      'cong': ['从', '聪', '葱', '匆', '囱', '琮', '淙', '苁'],
      'cou': ['凑', '凑', '辏'],
      'cu': ['粗', '促', '醋', '簇', '蹴', '卒'],
      'cuan': ['窜', '攒', '篡', '汆', '撺'],
      'cui': ['催', '脆', '翠', '摧', '瘁', '粹', '崔', '璀', '悴'],
      'cun': ['存', '寸', '村', '忖', '皴'],
      'cuo': ['错', '搓', '撮', '磋', '措', '挫', '锉', '厝'],
      'da': ['大', '打', '达', '答', '搭', '哒', '耷', '妲'],
      'dai': ['带', '代', '待', '戴', '袋', '逮', '怠', '贷', '黛', '傣', '埭'],
      'dan': ['单', '但', '蛋', '担', '弹', '淡', '丹', '胆', '旦', '氮', '耽', '郸'],
      'dang': ['当', '党', '挡', '荡', '档', '铛', '宕', '砀'],
      'dao': ['到', '道', '倒', '刀', '导', '岛', '盗', '蹈', '稻', '悼', '祷'],
      'de': ['的', '得', '德', '地', '等', '登'],
      'deng': ['等', '登', '灯', '邓', '瞪', '凳', '噔', '蹬', '澄'],
      'di': ['地', '第', '低', '帝', '滴', '底', '递', '敌', '堤', '笛', '狄', '涤'],
      'dian': ['点', '电', '店', '典', '垫', '殿', '颠', '惦', '淀', '佃', '滇', '碘'],
      'diao': ['调', '掉', '吊', '雕', '刁', '貂', '碉', '钓', '凋'],
      'die': ['叠', '爹', '跌', '碟', '蝶', '迭', '谍', '堞', '耋'],
      'ding': ['定', '丁', '顶', '钉', '鼎', '订', '叮', '锭', '仃', '啶'],
      'diu': ['丢'],
      'dong': ['动', '东', '懂', '冬', '洞', '栋', '董', '冻', '侗', '咚'],
      'dou': ['都', '斗', '抖', '豆', '陡', '兜', '窦', '蚪', '篼'],
      'du': ['度', '独', '读', '杜', '堵', '毒', '渡', '肚', '睹', '妒', '督', '牍'],
      'duan': ['段', '短', '断', '端', '锻', '缎', '椴'],
      'dui': ['对', '队', '堆', '兑', '怼', '镦'],
      'dun': ['顿', '盾', '吨', '蹲', '敦', '钝', '遁', '囤', '盹'],
      'duo': ['多', '朵', '夺', '躲', '舵', '剁', '惰', '堕', '哆', '掇'],
      'e': ['额', '饿', '俄', '哦', '鹅', '恶', '厄', '鄂', '讹', '遏', '垩', '萼'],
      'en': ['恩', '摁', '蒽'],
      'er': ['儿', '二', '尔', '耳', '饵', '迩', '洱', '贰'],
      'fa': ['发', '法', '罚', '伐', '阀', '筏', '珐'],
      'fan': ['反', '范', '翻', '凡', '犯', '饭', '繁', '帆', '返', '泛', '藩', '钒'],
      'fang': ['方', '放', '房', '防', '仿', '访', '芳', '纺', '舫', '肪', '彷'],
      'fei': ['飞', '非', '费', '肥', '废', '肺', '匪', '吠', '霏', '诽', '翡'],
      'fen': ['分', '粉', '奋', '份', '芬', '愤', '纷', '坟', '焚', '吩', '氛'],
      'feng': ['风', '封', '疯', '丰', '峰', '锋', '缝', '冯', '枫', '讽', '俸'],
      'fo': ['佛', '仏'],
      'fou': ['否', '缶'],
      'fu': ['不', '服', '副', '父', '夫', '符', '福', '浮', '府', '付', '负', '富'],
      'ga': ['嘎', '咖', '伽', '尬'],
      'gai': ['改', '该', '盖', '概', '丐', '垓', '赅', '溉'],
      'gan': ['干', '感', '敢', '甘', '赶', '杆', '肝', '秆', '赣', '柑', '橄'],
      'gang': ['刚', '钢', '岗', '港', '缸', '纲', '肛', '罡', '杠'],
      'gao': ['高', '搞', '告', '稿', '膏', '糕', '皋', '镐', '诰', '杲'],
      'ge': ['个', '各', '哥', '歌', '格', '隔', '阁', '戈', '鸽', '割', '疙', '胳'],
      'gei': ['给'],
      'gen': ['根', '跟', '艮', '哏'],
      'geng': ['更', '耕', '庚', '羹', '耿', '梗', '哽'],
      'gong': ['公', '工', '共', '功', '攻', '宫', '躬', '供', '巩', '拱', '贡'],
      'gou': ['够', '勾', '狗', '沟', '购', '苟', '钩', '垢', '构', '篝'],
      'gu': ['古', '谷', '故', '姑', '骨', '鼓', '顾', '孤', '辜', '菇', '沽', '雇'],
      'gua': ['瓜', '挂', '刮', '寡', '褂', '呱', '剐'],
      'guai': ['怪', '乖', '拐'],
      'guan': ['关', '管', '观', '馆', '冠', '惯', '灌', '官', '棺', '莞', '鹳'],
      'guang': ['光', '广', '逛', '胱', '犷'],
      'gui': ['归', '鬼', '桂', '贵', '规', '轨', '硅', '瑰', '闺', '柜', '跪'],
      'gun': ['滚', '棍', '衮', '鲧'],
      'guo': ['国', '过', '果', '锅', '裹', '郭', '聒', '帼', '椁'],
      'ha': ['哈', '蛤', '铪', '哈'],
      'hai': ['还', '海', '害', '亥', '孩', '骇', '嗨', '骸'],
      'han': ['汉', '含', '喊', '寒', '汗', '函', '罕', '翰', '韩', '憨', '邯', '悍'],
      'hang': ['行', '杭', '航', '夯', '吭', '颃'],
      'hao': ['好', '号', '豪', '耗', '浩', '郝', '毫', '镐', '蒿', '灏'],
      'he': ['和', '合', '河', '何', '贺', '禾', '核', '盒', '呵', '褐', '赫', '鹤'],
      'hei': ['黑', '嘿', '骇'],
      'hen': ['很', '狠', '恨', '痕'],
      'heng': ['横', '衡', '恒', '亨', '珩'],
      'hong': ['红', '洪', '轰', '虹', '鸿', '哄', '烘', '弘', '泓', '讧'],
      'hou': ['后', '候', '厚', '吼', '猴', '喉', '逅', 'hou'],
      'hu': ['户', '胡', '湖', '呼', '护', '互', '忽', '狐', '虎', '糊', '壶', '弧'],
      'hua': ['花', '化', '华', '划', '滑', '话', '哗', '猾', '骅'],
      'huai': ['怀', '坏', '淮', '槐', '徊'],
      'huan': ['还', '欢', '换', '环', '缓', '唤', '幻', '患', '焕', '宦', '桓'],
      'huang': ['黄', '荒', '慌', '皇', '晃', '谎', '煌', '凰', '惶', '璜', '蝗'],
      'hui': ['会', '回', '灰', '挥', '辉', '悔', '惠', '绘', '徽', '慧', '毁', '晦'],
      'hun': ['混', '昏', '魂', '浑', '荤', '馄', '诨'],
      'huo': ['火', '或', '货', '获', '祸', '伙', '豁', '霍', '惑', '藿'],
      'ji': ['几', '及', '即', '记', '计', '级', '机', '基', '积', '鸡', '饥', '激'],
      'jia': ['家', '加', '价', '假', '架', '甲', '夹', '佳', '贾', '稼', '伽', '荚'],
      'jian': ['见', '间', '件', '建', '减', '键', '尖', '坚', '监', '简', '检', '箭'],
      'jiang': ['江', '将', '讲', '奖', '降', '蒋', '酱', '僵', '疆', '匠', '桨'],
      'jiao': ['交', '叫', '教', '角', '觉', '较', '胶', '焦', '骄', '浇', '椒', '狡'],
      'jie': ['结', '解', '界', '节', '接', '街', '姐', '阶', '捷', '劫', '洁', '戒'],
      'jin': ['进', '金', '尽', '紧', '今', '斤', '禁', '锦', '津', '筋', '巾', '瑾'],
      'jing': ['经', '静', '景', '精', '竟', '井', '境', '警', '晶', '京', '惊', '径'],
      'jiong': ['窘', '炯', '扃', '冏'],
      'jiu': ['就', '九', '久', '旧', '酒', '救', '究', '揪', '舅', '韭', '玖'],
      'ju': ['句', '居', '局', '举', '巨', '具', '剧', '聚', '菊', '橘', '矩', '驹'],
      'juan': ['卷', '倦', '捐', '绢', '眷', '涓', '隽', '倦'],
      'jue': ['决', '觉', '绝', '爵', '掘', '诀', '厥', '倔', '攫', '谲'],
      'jun': ['军', '均', '君', '俊', '骏', '竣', '郡', '钧', '筠'],
      'ka': ['卡', '咖', '喀', '佧'],
      'kai': ['开', '凯', '楷', '慨', '揩', '锴', '恺'],
      'kan': ['看', '刊', '砍', '坎', '侃', '勘', '龛', '瞰', '阚'],
      'kang': ['康', '抗', '扛', '炕', '慷', '亢', '糠', '伉'],
      'kao': ['考', '靠', '烤', '拷', '铐', '犒', '尻'],
      'ke': ['可', '克', '客', '课', '科', '颗', '刻', '渴', '柯', '壳', '坷', '呵'],
      'ken': ['肯', '啃', '垦', '恳', '龈'],
      'keng': ['坑', '吭', '铿'],
      'kong': ['空', '孔', '控', '恐', '崆', '箜'],
      'kou': ['口', '扣', '寇', '叩', '蔻'],
      'ku': ['苦', '库', '哭', '裤', '枯', '酷', '窟', '骷', '刳'],
      'kua': ['夸', '垮', '挎', '胯', '侉'],
      'kuai': ['快', '块', '怪', '筷', '蒯', '会'],
      'kuan': ['宽', '款', '髋'],
      'kuang': ['狂', '矿', '框', '况', '旷', '筐', '眶', '诳'],
      'kui': ['亏', '愧', '溃', '葵', '魁', '窥', '盔', '逵', '馗'],
      'kun': ['困', '昆', '捆', '坤', '鲲', '锟', '醌'],
      'kuo': ['扩', '括', '阔', '廓', '蛞'],
      'la': ['拉', '啦', '辣', '蜡', '腊', '垃', '喇', '邋'],
      'lai': ['来', '赖', '莱', '籁', '癞', '涞'],
      'lan': ['兰', '蓝', '烂', '栏', '拦', '篮', '懒', '揽', '澜', '婪', '榄'],
      'lang': ['浪', '郎', '朗', '狼', '廊', '琅', '榔', '螂'],
      'lao': ['老', '劳', '牢', '涝', '烙', '酪', '唠', '崂', '痨'],
      'le': ['了', '乐', '勒', '肋', '嘞'],
      'lei': ['类', '雷', '累', '泪', '磊', '蕾', '垒', '擂', '肋', '羸'],
      'leng': ['冷', '愣', '棱'],
      'li': ['里', '利', '离', '李', '理', '立', '力', '例', '礼', '莉', '璃', '梨'],
      'lia': ['俩'],
      'lian': ['连', '联', '脸', '练', '恋', '莲', '怜', '炼', '敛', '廉', '涟'],
      'liang': ['两', '量', '亮', '凉', '梁', '良', '粮', '辆', '靓', '谅'],
      'liao': ['了', '料', '聊', '辽', '疗', '燎', '廖', '寥', '撩', '镣'],
      'lie': ['列', '裂', '烈', '劣', '猎', '冽', '鬣', '咧'],
      'lin': ['林', '临', '淋', '邻', '鳞', '琳', '霖', '磷', '吝', '赁'],
      'ling': ['令', '灵', '领', '零', '龄', '铃', '陵', '岭', '凌', '菱', '伶'],
      'liu': ['流', '留', '刘', '六', '柳', '硫', '溜', '瘤', '榴', '浏'],
      'long': ['龙', '隆', '笼', '弄', '聋', '垄', '陇', '珑', '胧', '窿'],
      'lou': ['楼', '漏', '露', '娄', '搂', '喽', '陋', '镂'],
      'lu': ['路', '露', '陆', '录', '鹿', '炉', '卢', '鲁', '禄', '芦', '颅', '卤'],
      'lv': ['旅', '绿', '吕', '律', '屡', '虑', '滤', '侣', '履', '铝'],
      'luan': ['乱', '卵', '滦', '銮', '孪', '挛'],
      'lue': ['掠', '略'],
      'lun': ['论', '轮', '伦', '仑', '沦', '纶', '抡', '囵'],
      'luo': ['罗', '落', '洛', '骆', '络', '螺', '萝', '逻', '锣', '裸'],
      'ma': ['马', '吗', '麻', '骂', '码', '玛', '蚂', '嘛', '蟆'],
      'mai': ['卖', '买', '麦', '埋', '脉', '迈', '霾'],
      'man': ['满', '慢', '曼', '漫', '蛮', '馒', '蔓', '幔', '鳗'],
      'mang': ['忙', '芒', '盲', '茫', '莽', '氓', '邙'],
      'mao': ['毛', '冒', '猫', '帽', '貌', '茅', '茂', '卯', '铆', '贸'],
      'me': ['么', '嚒'],
      'mei': ['没', '每', '美', '妹', '梅', '煤', '眉', '味', '媚', '霉', '玫'],
      'men': ['门', '们', '闷', '焖', '扪'],
      'meng': ['梦', '猛', '蒙', '盟', '萌', '孟', '朦', '檬', '勐'],
      'mi': ['米', '密', '迷', '秘', '蜜', '觅', '幂', '咪', '糜', '弥'],
      'mian': ['面', '棉', '免', '绵', '眠', '勉', '娩', '冕', '腼'],
      'miao': ['苗', '描', '秒', '庙', '妙', '喵', '缈', '淼'],
      'mie': ['灭', '蔑', '咩', '篾'],
      'min': ['民', '敏', '闽', '抿', '悯', '岷', '珉'],
      'ming': ['明', '名', '命', '鸣', '铭', '冥', '茗', '溟'],
      'miu': ['谬', '缪'],
      'mo': ['莫', '模', '磨', '末', '默', '墨', '膜', '沫', '寞', '谟', '茉'],
      'mou': ['某', '谋', '牟', '眸', '缪'],
      'mu': ['目', '木', '母', '墓', '慕', '暮', '牧', '亩', '穆', '沐', '睦'],
      'na': ['那', '拿', '纳', '娜', '呐', '钠', '捺', '衲'],
      'nai': ['乃', '奶', '耐', '奈', '萘', '氖'],
      'nan': ['南', '难', '男', '楠', '喃', '囡'],
      'nang': ['囊', '囔', '馕'],
      'nao': ['脑', '闹', '恼', '挠', '瑙', '铙'],
      'ne': ['呢', '哪', '呐'],
      'nei': ['内', '馁', '氖'],
      'nen': ['嫩', '恁'],
      'neng': ['能', '儜'],
      'ni': ['你', '尼', '泥', '呢', '妮', '霓', '倪', '拟', '匿', '腻'],
      'nian': ['年', '念', '粘', '碾', '拈', '蔫', '谸', '辇'],
      'niang': ['娘', '酿', '嬢'],
      'niao': ['鸟', '尿', '袅', '茑'],
      'nie': ['呢', '捏', '聂', '孽', '啮', '涅', '镊', '镍'],
      'nin': ['您'],
      'ning': ['宁', '凝', '柠', '狞', '泞', '佞'],
      'niu': ['牛', '扭', '纽', '钮', '拗', '妞'],
      'nong': ['农', '弄', '浓', '脓', '侬'],
      'nou': ['耨'],
      'nu': ['奴', '努', '怒', '弩', '胬'],
      'nv': ['女', '钕'],
      'nuan': ['暖', '煖'],
      'nue': ['虐', '疟'],
      'nuo': ['诺', '糯', '挪', '懦', '喏'],
      'o': ['哦', '喔', '噢', '嚄'],
      'ou': ['偶', '欧', '呕', '鸥', '殴', '藕', '讴', '瓯'],
      'pa': ['怕', '爬', '帕', '趴', '琶', '葩', '啪'],
      'pai': ['拍', '排', '派', '牌', '徘', '湃', '哌'],
      'pan': ['盘', '判', '盼', '攀', '潘', '畔', '磐', '泮', '拚'],
      'pang': ['旁', '胖', '庞', '乓', '彷', '滂', '螃'],
      'pao': ['跑', '泡', '抛', '炮', '袍', '刨', '咆', '疱', '匏'],
      'pei': ['配', '培', '赔', '陪', '沛', '佩', '裴', '胚', '呸'],
      'pen': ['盆', '喷', '湓'],
      'peng': ['朋', '鹏', '碰', '彭', '蓬', '棚', '膨', '澎', '烹', '砰'],
      'pi': ['皮', '批', '疲', '脾', '匹', '屁', '辟', '啤', '毗', '琵', '霹'],
      'pian': ['片', '偏', '篇', '骗', '翩', '谝', '骈'],
      'piao': ['漂', '飘', '票', '嫖', '缥', '剽', '瞟'],
      'pie': ['撇', '瞥', '苤'],
      'pin': ['品', '拼', '贫', '聘', '嫔', '频', '颦'],
      'ping': ['平', '评', '瓶', '乒', '萍', '凭', '坪', '屏', '苹'],
      'po': ['破', '坡', '婆', '泼', '泊', '颇', '魄', '叵', '粕'],
      'pu': ['普', '扑', '铺', '葡', '蒲', '仆', '浦', '谱', '曝', '瀑'],
      'qi': ['起', '七', '气', '其', '期', '奇', '器', '妻', '弃', '汽', '漆', '凄'],
      'qia': ['恰', '卡', '掐', '洽', '髂'],
      'qian': ['前', '钱', '千', '欠', '签', '牵', '浅', '迁', '谦', '铅', '潜', '遣'],
      'qiang': ['强', '枪', '墙', '抢', '呛', '腔', '蔷', '羌', '襁'],
      'qiao': ['桥', '巧', '乔', '瞧', '悄', '鞘', '撬', '樵', '荞'],
      'qie': ['切', '且', '茄', '怯', '窃', '挈', '锲'],
      'qin': ['亲', '秦', '琴', '勤', '禽', '沁', '寝', '擒', '钦'],
      'qing': ['请', '情', '清', '青', '庆', '轻', '晴', '顷', '卿', '氢', '擎'],
      'qiong': ['穷', '琼', '穹', '邛'],
      'qiu': ['求', '秋', '球', '丘', '囚', '邱', '裘', '酋', '蚯'],
      'qu': ['去', '取', '区', '曲', '趣', '驱', '屈', '渠', '娶', '蛆', '躯'],
      'quan': ['全', '权', '泉', '圈', '劝', '券', '拳', '犬', '诠', '醛'],
      'que': ['却', '缺', '雀', '确', '鹊', '炔', '榷', '阙'],
      'qun': ['群', '裙', '逡'],
      'ran': ['然', '染', '燃', '冉', '髯'],
      'rang': ['让', '嚷', '壤', '瓤', '攘', 'rang'],
      'rao': ['绕', '饶', '扰', '娆', '桡'],
      're': ['热', '惹'],
      'ren': ['人', '任', '忍', '认', '仁', '韧', '刃', '妊', '纫'],
      'reng': ['仍', '扔', '礽'],
      'ri': ['日'],
      'rong': ['容', '荣', '融', '绒', '熔', '戎', '茸', '冗', '榕'],
      'rou': ['肉', '揉', '柔', '蹂', '鞣'],
      'ru': ['入', '如', '儒', '乳', '辱', '汝', '茹', '孺', '褥'],
      'ruan': ['软', '阮', '朊'],
      'rui': ['瑞', '锐', '蕊', '睿', '芮'],
      'run': ['润', '闰', '潤'],
      'ruo': ['若', '弱', '偌', '箬'],
      'sa': ['撒', '萨', '仨', '飒'],
      'sai': ['塞', '腮', '赛', '鳃', '噻'],
      'san': ['三', '散', '伞', '叁', '馓'],
      'sang': ['桑', '丧', '嗓', '搡'],
      'sao': ['扫', '嫂', '骚', '臊', '缫'],
      'se': ['色', '塞', '瑟', '涩', '啬', '铯'],
      'sen': ['森', '椮'],
      'seng': ['僧'],
      'sha': ['杀', '沙', '啥', '傻', '纱', '煞', '砂', '鲨', '霎'],
      'shai': ['晒', '筛', '色'],
      'shan': ['山', '善', '扇', '衫', '闪', '单', '删', '陕', '珊', '擅', '赡'],
      'shang': ['上', '商', '伤', '赏', '尚', '裳', '晌', '殇'],
      'shao': ['少', '绍', '烧', '稍', '勺', '哨', '邵', '韶', '芍'],
      'she': ['设', '社', '射', '蛇', '舍', '摄', '涉', '舌', '奢', '赦'],
      'shen': ['深', '身', '神', '伸', '审', '沈', '肾', '甚', '慎', '绅', '呻'],
      'sheng': ['生', '升', '声', '省', '圣', '胜', '剩', '盛', '甥', '牲'],
      'shi': ['是', '时', '事', '市', '师', '十', '石', '史', '使', '实', '食', '室'],
      'shou': ['手', '收', '受', '首', '守', '寿', '兽', '售', '授', '瘦'],
      'shu': ['书', '数', '树', '属', '术', '输', '叔', '舒', '鼠', '署', '熟', '殊'],
      'shua': ['刷', '耍', '唰'],
      'shuai': ['帅', '率', '摔', '衰', '蟀'],
      'shuan': ['拴', '栓', '涮'],
      'shuang': ['双', '霜', '爽', '孀'],
      'shui': ['水', '睡', '税', '谁'],
      'shun': ['顺', '瞬', '舜', '吮'],
      'shuo': ['说', '硕', '烁', '朔', '妁', '铄'],
      'si': ['四', '思', '死', '丝', '司', '私', '寺', '斯', '撕', '肆', '嗣'],
      'song': ['送', '松', '宋', '颂', '耸', '讼', '嵩', '怂'],
      'sou': ['搜', '艘', '擞', '嗽', '叟', '嗾'],
      'su': ['苏', '素', '诉', '速', '宿', '俗', '塑', '酥', '肃', '粟'],
      'suan': ['算', '酸', '蒜', '涮'],
      'sui': ['随', '岁', '碎', '虽', '隋', '遂', '绥', '髓', '穗'],
      'sun': ['孙', '损', '笋', '隼', '荪'],
      'suo': ['所', '锁', '缩', '索', '琐', '唆', '娑', '唢'],
      'ta': ['他', '她', '它', '塔', '塌', '踏', '榻', '拓', '挞'],
      'tai': ['太', '台', '态', '泰', '胎', '抬', '苔', '汰', '肽', '邰'],
      'tan': ['谈', '探', '弹', '碳', '滩', '潭', '坦', '贪', '叹', '炭', '毯'],
      'tang': ['唐', '堂', '糖', '汤', '躺', '烫', '塘', '倘', '趟', '棠'],
      'tao': ['套', '桃', '逃', '淘', '涛', '讨', '滔', '韬', '萄', '陶'],
      'te': ['特', '忑', '忒'],
      'teng': ['腾', '疼', '藤', '誊'],
      'ti': ['体', '提', '题', '替', '踢', '梯', '蹄', '剃', '涕', '屉', '啼'],
      'tian': ['天', '田', '填', '甜', '添', '舔', '腆', '佃'],
      'tiao': ['条', '调', '跳', '挑', '眺', '迢', '苕', '窕', '铫'],
      'tie': ['铁', '贴', '帖', '餮'],
      'ting': ['听', '停', '庭', '挺', '厅', '艇', '汀', '霆', '婷'],
      'tong': ['同', '通', '铜', '童', '桶', '痛', '统', '筒', '瞳', '桐'],
      'tou': ['头', '投', '透', '偷', '骰'],
      'tu': ['图', '土', '涂', '突', '吐', '徒', '屠', '兔', '途', '凸'],
      'tuan': ['团', '湍', '抟', '疃'],
      'tui': ['推', '退', '腿', '颓', '蜕', '褪'],
      'tun': ['吞', '吨', '臀', '囤', '褪', '饨'],
      'tuo': ['托', '脱', '拖', '妥', '陀', '驼', '拓', '唾', '椭', '跎'],
      'wa': ['瓦', '挖', '娃', '蛙', '洼', '袜', '娲'],
      'wai': ['外', '歪', '崴'],
      'wan': ['万', '完', '晚', '玩', '湾', '丸', '碗', '挽', '婉', '腕', '皖'],
      'wang': ['王', '往', '网', '望', '忘', '旺', '亡', '枉', '惘'],
      'wei': ['为', '位', '未', '味', '微', '威', '围', '伟', '违', '唯', '卫', '慰'],
      'wen': ['文', '问', '温', '闻', '稳', '纹', '吻', '紊', '雯', '刎'],
      'weng': ['翁', '嗡', '瓮', '蓊'],
      'wo': ['我', '窝', '卧', '握', '沃', '蜗', '挝', '渥'],
      'wu': ['无', '五', '午', '物', '武', '舞', '吴', '屋', '乌', '污', '雾', '悟'],
      'xi': ['西', '喜', '系', '细', '习', '吸', '希', '息', '析', '溪', '锡', '稀'],
      'xia': ['下', '夏', '虾', '峡', '霞', '侠', '瞎', '辖', '暇', '瑕'],
      'xian': ['先', '线', '现', '显', '县', '鲜', '闲', '仙', '险', '贤', '嫌', '弦'],
      'xiang': ['想', '向', '相', '象', '香', '乡', '箱', '祥', '享', '响', '巷', '镶'],
      'xiao': ['小', '笑', '消', '效', '销', '晓', '萧', '霄', '削', '硝', '潇'],
      'xie': ['写', '些', '谢', '鞋', '邪', '斜', '解', '卸', '屑', '泄', '蟹', '协'],
      'xin': ['心', '新', '信', '辛', '欣', '鑫', '薪', '馨', '芯'],
      'xing': ['行', '星', '兴', '性', '形', '型', '醒', '幸', '杏', '姓', '刑'],
      'xiong': ['熊', '胸', '雄', '凶', '兄', '匈'],
      'xiu': ['修', '休', '秀', '袖', '锈', '羞', '宿', '嗅'],
      'xu': ['许', '需', '须', '徐', '序', '叙', '续', '虚', '婿', '墟', '蓄'],
      'xuan': ['选', '宣', '旋', '悬', '喧', '轩', '玄', '癣', '绚', '眩'],
      'xue': ['学', '雪', '血', '薛', '穴', '削', '靴'],
      'xun': ['寻', '训', '讯', '迅', '巡', '勋', '询', '荀', '殉', '浚'],
      'ya': ['呀', '压', '牙', '雅', '亚', '哑', '崖', '鸭', '涯', '衙'],
      'yan': ['眼', '言', '沿', '严', '研', '烟', '盐', '演', '艳', '燕', '验', '岩'],
      'yang': ['阳', '杨', '扬', '样', '养', '羊', '洋', '痒', '央', '鸯', '秧'],
      'yao': ['要', '药', '摇', '咬', '遥', '姚', '窑', '谣', '耀', '妖', '夭'],
      'ye': ['也', '叶', '夜', '业', '野', '爷', '耶', '冶', '椰', '曳'],
      'yi': ['一', '以', '已', '衣', '依', '医', '易', '义', '议', '异', '艺', '益'],
      'yin': ['因', '银', '音', '引', '饮', '隐', '印', '阴', '吟', '姻', '尹'],
      'ying': ['应', '英', '影', '硬', '营', '迎', '盈', '颖', '鹰', '樱', '婴'],
      'yo': ['哟', '唷'],
      'yong': ['用', '永', '勇', '拥', '庸', '泳', '咏', '甬', '俑', '痈'],
      'you': ['有', '由', '油', '游', '优', '友', '右', '幼', '诱', '佑', '悠'],
      'yu': ['于', '与', '语', '雨', '欲', '遇', '鱼', '余', '予', '玉', '域', '愈'],
      'yuan': ['元', '原', '员', '圆', '院', '远', '愿', '怨', '袁', '援', '源', '缘'],
      'yue': ['月', '越', '悦', '乐', '岳', '跃', '粤', '阅', '玥'],
      'yun': ['云', '运', '匀', '允', '孕', '晕', '韵', '耘', '蕴', '酝'],
      'za': ['杂', '砸', '扎', '匝', '咂'],
      'zai': ['在', '再', '载', '灾', '宰', '哉', '崽'],
      'zan': ['赞', '暂', '咱', '攒', '簪', '昝'],
      'zang': ['脏', '藏', '葬', '赃', '奘'],
      'zao': ['早', '造', '遭', '澡', '燥', '躁', '枣', '灶', '皂', '凿'],
      'ze': ['则', '泽', '责', '择', '仄', '啧', '笮'],
      'zei': ['贼'],
      'zen': ['怎', '谮'],
      'zeng': ['增', '曾', '赠', '憎', '甑'],
      'zha': ['扎', '渣', '炸', '闸', '眨', '札', '轧', '榨', '诈', '乍'],
      'zhai': ['摘', '宅', '窄', '债', '寨', '翟'],
      'zhan': ['站', '战', '占', '展', '盏', '斩', '瞻', '粘', '詹', '谵'],
      'zhang': ['张', '长', '章', '涨', '掌', '障', '彰', '樟', '丈', '帐'],
      'zhao': ['照', '找', '招', '赵', '兆', '罩', '昭', '沼', '肇', '钊'],
      'zhe': ['这', '着', '折', '哲', '浙', '遮', '辙', '蛰', '锗'],
      'zhen': ['真', '阵', '镇', '震', '珍', '诊', '针', '枕', '甄', '臻'],
      'zheng': ['正', '整', '证', '争', '征', '症', '蒸', '睁', '挣', '政'],
      'zhi': ['之', '只', '知', '直', '指', '治', '制', '智', '志', '质', '支', '织'],
      'zhong': ['中', '种', '重', '众', '终', '钟', '忠', '肿', '仲', '衷'],
      'zhou': ['周', '州', '舟', '洲', '咒', '皱', '宙', '昼', '骤', '帚'],
      'zhu': ['主', '住', '助', '祝', '筑', '朱', '珠', '猪', '竹', '烛', '煮', '诸'],
      'zhua': ['抓', '爪'],
      'zhuai': ['拽'],
      'zhuan': ['转', '专', '传', '砖', '撰', '赚', '篆', '颛'],
      'zhuang': ['装', '庄', '状', '撞', '妆', '幢', '奘'],
      'zhui': ['追', '坠', '椎', '缀', '赘', '惴'],
      'zhun': ['准', '谆', '肫'],
      'zhuo': ['着', '桌', '捉', '拙', '灼', '浊', '酌', '茁', '卓', '琢'],
      'zi': ['子', '自', '字', '紫', '资', '姿', '兹', '咨', '仔', '籽', '吱'],
      'zong': ['总', '宗', '纵', '踪', '棕', '鬃', '粽'],
      'zou': ['走', '奏', '揍', '邹', '驺'],
      'zu': ['组', '祖', '族', '租', '阻', '足', '卒', '诅', '俎'],
      'zuan': ['钻', '纂', '攥', '缵'],
      'zui': ['最', '嘴', '醉', '罪', '蕞'],
      'zun': ['尊', '遵', '樽', '撙'],
      'zuo': ['做', '左', '坐', '座', '作', '昨', '佐', '祚']
    };

    // 初始化页面
    window.onload = function() {
      // 创建动态背景
      createDynamicBackground();
      // 启动动态渐变背景
      startDynamicGradient();
      
      // 默认添加几个常用模块
      addModule('clock', { x: 50, y: 30 });
      addModule('tasks', { x: 20, y: 50 });
      addModule('weather', { x: 70, y: 50 });
      
      // 绑定添加模块按钮事件
      document.getElementById('add-module-btn').onclick = toggleModuleMenu;
      
      // 绑定模块选择事件
      var menuButtons = document.querySelectorAll('#module-menu button');
      for (var i = 0; i < menuButtons.length; i++) {
        menuButtons[i].onclick = function(e) {
          var moduleType = this.getAttribute('data-module');
          // 随机位置添加模块
          var randomX = 20 + Math.random() * 60;
          var randomY = 20 + Math.random() * 60;
          addModule(moduleType, { x: randomX, y: randomY });
          toggleModuleMenu();
        };
      }
      
      // 绑定虚拟键盘事件
      bindKeyboardEvents();
      
      // 绑定摇杆控制事件
      bindJoystickEvents();
    };

    // 创建动态背景
    function createDynamicBackground() {
      var container = document.getElementById('dynamic-background');
      
      // 添加大型装饰元素
      var largeDecorations = [
        { size: 120, color: 'primary', top: '-30', right: '-30' },
        { size: 90, color: 'secondary', top: '1/4', left: '-40' },
        { size: 70, color: 'accent', bottom: '10%', right: '20%' }
      ];
      
      for (var i = 0; i < largeDecorations.length; i++) {
        var decor = largeDecorations[i];
        var elem = document.createElement('div');
        elem.className = 'absolute ' + (decor.color === 'primary' ? 'bg-primary/10' : decor.color === 'secondary' ? 'bg-secondary/10' : 'bg-accent/10') + ' rounded-full blur-3xl';
        elem.style.width = decor.size + 'px';
        elem.style.height = decor.size + 'px';
        if (decor.top) elem.style.top = decor.top;
        if (decor.right) elem.style.right = decor.right;
        if (decor.bottom) elem.style.bottom = decor.bottom;
        if (decor.left) elem.style.left = decor.left;
        
        // 随机动画
        var animationClass = Math.random() > 0.5 ? 'float-slow' : 'float-fast';
        elem.className += ' ' + animationClass;
        
        container.appendChild(elem);
      }
      
      // 创建漂浮粒子（大小差异明显）
      for (var i = 0; i < particleCount; i++) {
        createParticle(container);
      }
    }
    
    // 创建单个粒子（大小差异明显）
    function createParticle(container) {
      var particle = document.createElement('div');
      // 大小差异明显：5px到100px之间
      var size = Math.random() * 95 + 5;
      var x = Math.random() * 100; // 0-100%
      var y = Math.random() * 100; // 0-100%
      var opacity = Math.random() * 0.1 + 0.05; // 0.05-0.15
      
      // 随机选择颜色
      var colors = ['bg-primary', 'bg-secondary', 'bg-accent'];
      var color = colors[Math.floor(Math.random() * colors.length)];
      
      particle.className = 'absolute ' + color + ' rounded-full';
      particle.style.width = size + 'px';
      particle.style.height = size + 'px';
      particle.style.left = x + '%';
      particle.style.top = y + '%';
      particle.style.opacity = opacity;
      
      // 随机动画速度
      var animationClass = Math.random() > 0.7 ? 'float-fast' : (Math.random() > 0.5 ? 'floating' : 'float-slow');
      particle.className += ' ' + animationClass;
      
      container.appendChild(particle);
      particles.push(particle);
      
      // 为粒子添加随机移动动画
      animateParticle(particle);
    }
    
    // 粒子动画
    function animateParticle(particle) {
      var duration = Math.random() * 40 + 20; // 20-60秒
      var targetX = Math.random() * 100;
      var targetY = Math.random() * 100;
      
      // 平滑过渡到新位置
      particle.style.transition = 'left ' + duration + 's ease, top ' + duration + 's ease';
      particle.style.left = targetX + '%';
      particle.style.top = targetY + '%';
      
      // 完成后再次动画
      setTimeout(function() {
        animateParticle(particle);
      }, duration * 1000);
    }
    
    // 动态渐变背景
    function startDynamicGradient() {
      var body = document.getElementById('dynamic-bg');
      var gradients = [
        'linear-gradient(135deg, #fefefe 0%, #f8e9d9 100%)',
        'linear-gradient(135deg, #fefefe 0%, #eef2f7 100%)',
        'linear-gradient(135deg, #fefefe 0%, #f0f7ea 100%)',
        'linear-gradient(135deg, #fefefe 0%, #fce4ec 100%)',
        'linear-gradient(135deg, #fefefe 0%, #e8eaf6 100%)'
      ];
      
      var currentIndex = 0;
      
      function changeGradient() {
        currentIndex = (currentIndex + 1) % gradients.length;
        body.style.background = gradients[currentIndex];
        // 每15秒切换一次
        setTimeout(changeGradient, 15000);
      }
      
      // 初始设置
      body.style.background = gradients[0];
      body.style.transition = 'background 10s ease';
      
      // 启动切换
      setTimeout(changeGradient, 15000);
    }

    // 切换模块菜单显示/隐藏
    function toggleModuleMenu() {
      var menu = document.getElementById('module-menu');
      if (menu.className.indexOf('hidden') !== -1) {
        menu.className = menu.className.replace('hidden', '');
      } else {
        menu.className += ' hidden';
      }
    }

    // 添加新模块
    function addModule(type, position) {
      var moduleId = 'module-' + type + '-' + moduleIdCounter++;
      var container = document.getElementById('modules-container');
      
      // 创建模块元素
      var module = document.createElement('div');
      module.id = moduleId;
      module.setAttribute('data-type', type);
      module.className = 'absolute bg-white/90 backdrop-blur-md rounded-2xl shadow-lg p-5 w-72 card-hover';
      module.style.left = position.x + '%';
      module.style.top = position.y + '%';
      module.style.transform = 'translate(-50%, -50%)';
      module.setAttribute('data-scale', '1');
      module.setAttribute('data-text-scale', '1');
      
      // 根据模块类型设置内容
      switch(type) {
        case 'clock':
          module.innerHTML = '\
            <div class="flex justify-between items-center mb-3">\
              <h3 class="font-semibold text-dark flex items-center">\
                <span class="mr-2">⌚</span>时钟日期\
              </h3>\
              <div class="flex space-x-1">\
                <span class="module-drag p-1 text-gray-400 hover:text-gray-600">\
                  <span>↔</span>\
                </span>\
                <span class="delete-module p-1 text-gray-400 hover:text-red-500 cursor-pointer">\
                  <span>×</span>\
                </span>\
              </div>\
            </div>\
            <div id="clock-display-' + moduleId + '" class="text-3xl md:text-4xl font-bold text-dark text-center leading-tight">\
              00:00:00\
            </div>\
            <div id="date-display-' + moduleId + '" class="text-gray-500 text-center mt-2">\
              星期一, 2023年1月1日\
            </div>';
          break;
          
        case 'tasks':
          module.innerHTML = '\
            <div class="flex justify-between items-center mb-3">\
              <h3 class="font-semibold text-dark flex items-center">\
                <span class="mr-2">✓</span>今日待办\
              </h3>\
              <div class="flex space-x-1">\
                <span class="module-drag p-1 text-gray-400 hover:text-gray-600">\
                  <span>↔</span>\
                </span>\
                <span class="delete-module p-1 text-gray-400 hover:text-red-500 cursor-pointer">\
                  <span>×</span>\
                </span>\
              </div>\
            </div>\
            <div id="task-list-' + moduleId + '" class="space-y-2 max-h-60 overflow-y-auto pr-2 mb-3">\
              <div class="task-item flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-50">\
                <input type="checkbox" class="task-checkbox w-4 h-4 rounded text-primary focus:ring-primary">\
                <span class="task-text flex-1 text-sm">审核新季度食材供应商</span>\
              </div>\
              <div class="task-item flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-50">\
                <input type="checkbox" class="task-checkbox w-4 h-4 rounded text-primary focus:ring-primary" checked>\
                <span class="task-text flex-1 text-sm line-through text-gray-400">完成周度销售报表</span>\
              </div>\
            </div>\
            <div class="flex">\
              <input type="text" id="new-task-input-' + moduleId + '" placeholder="添加新任务..." class="flex-1 px-3 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary text-sm">\
              <span id="show-keyboard-' + moduleId + '" class="ml-2 w-8 h-8 rounded-lg bg-primary/10 text-primary flex items-center justify-center hover:bg-primary/20 transition cursor-pointer">\
                <span>⌨</span>\
              </span>\
            </div>';
          break;
          
        case 'weather':
          module.innerHTML = '\
            <div class="flex justify-between items-center mb-3">\
              <h3 class="font-semibold text-dark flex items-center">\
                <span class="mr-2">☁</span>天气信息\
              </h3>\
              <div class="flex space-x-1">\
                <span class="module-drag p-1 text-gray-400 hover:text-gray-600">\
                  <span>↔</span>\
                </span>\
                <span class="delete-module p-1 text-gray-400 hover:text-red-500 cursor-pointer">\
                  <span>×</span>\
                </span>\
              </div>\
            </div>\
            <div id="weather-info-' + moduleId + '" class="flex items-center justify-center space-x-4 text-gray-600 mb-4">\
              <div id="weather-icon-' + moduleId + '" class="text-4xl">\
                <span>☀</span>\
              </div>\
              <div class="text-center">\
                <div class="text-2xl font-bold" id="temperature-' + moduleId + '">24°C</div>\
                <div class="text-sm" id="weather-desc-' + moduleId + '">晴朗</div>\
                <div class="text-xs text-gray-400" id="weather-location-' + moduleId + '">加载中...</div>\
              </div>\
            </div>\
            <div class="flex justify-center text-sm text-gray-500 space-x-4 mb-2">\
              <div class="flex items-center">\
                <span class="mr-1">💧</span>\
                <span id="humidity-' + moduleId + '">湿度: --%</span>\
              </div>\
              <div class="flex items-center">\
                <span class="mr-1">💨</span>\
                <span id="wind-' + moduleId + '">风速: --km/h</span>\
              </div>\
            </div>\
            <div class="h-24">\
              <canvas id="temperature-chart-' + moduleId + '"></canvas>\
            </div>';
          break;
          
        case 'notes':
          module.innerHTML = '\
            <div class="flex justify-between items-center mb-3">\
              <h3 class="font-semibold text-dark flex items-center">\
                <span class="mr-2">📝</span>便签\
              </h3>\
              <div class="flex space-x-1">\
                <span class="module-drag p-1 text-gray-400 hover:text-gray-600">\
                  <span>↔</span>\
                </span>\
                <span class="delete-module p-1 text-gray-400 hover:text-red-500 cursor-pointer">\
                  <span>×</span>\
                </span>\
              </div>\
            </div>\
            <div id="notes-content-' + moduleId + '" class="min-h-32 bg-gray-50 rounded-lg p-3 text-sm mb-3 outline-none" contenteditable="true">\
              点击此处开始编辑便签...\
            </div>\
            <span id="show-notes-keyboard-' + moduleId + '" class="w-full py-2 rounded-lg bg-primary/10 text-primary hover:bg-primary/20 transition text-sm inline-block text-center cursor-pointer">\
              <span>⌨</span> 显示键盘\
            </span>';
          break;
          
        case 'calculator':
          module.innerHTML = '\
            <div class="flex justify-between items-center mb-3">\
              <h3 class="font-semibold text-dark flex items-center">\
                <span class="mr-2">🧮</span>计算器\
              </h3>\
              <div class="flex space-x-1">\
                <span class="module-drag p-1 text-gray-400 hover:text-gray-600">\
                  <span>↔</span>\
                </span>\
                <span class="delete-module p-1 text-gray-400 hover:text-red-500 cursor-pointer">\
                  <span>×</span>\
                </span>\
              </div>\
            </div>\
            <div id="calc-display-' + moduleId + '" class="bg-gray-50 rounded-lg p-3 mb-3 text-right font-mono text-lg">0</div>\
            <div class="grid grid-cols-4 gap-2">\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="C">C</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="←">←</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="%">%</span>\
              <span class="calc-btn bg-primary/10 text-primary rounded-md p-2 text-center cursor-pointer" data-value="/">÷</span>\
              
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="7">7</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="8">8</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="9">9</span>\
              <span class="calc-btn bg-primary/10 text-primary rounded-md p-2 text-center cursor-pointer" data-value="*">×</span>\
              
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="4">4</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="5">5</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="6">6</span>\
              <span class="calc-btn bg-primary/10 text-primary rounded-md p-2 text-center cursor-pointer" data-value="-">-</span>\
              
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="1">1</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="2">2</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="3">3</span>\
              <span class="calc-btn bg-primary/10 text-primary rounded-md p-2 text-center cursor-pointer" data-value="+">+</span>\
              
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="+/-">±</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value="0">0</span>\
              <span class="calc-btn bg-gray-100 rounded-md p-2 text-center cursor-pointer" data-value=".">.</span>\
              <span class="calc-btn bg-primary text-white rounded-md p-2 text-center cursor-pointer" data-value="=">=</span>\
            </div>';
          break;
      }
      
      // 添加到容器
      container.appendChild(module);
      addedModules.push({ id: moduleId, type: type });
      
      // 绑定模块事件
      bindModuleEvents(moduleId, type);
      
      // 初始化模块功能
      initModuleFunctions(moduleId, type);
    }

    // 绑定模块事件
    function bindModuleEvents(moduleId, type) {
      var module = document.getElementById(moduleId);
      
      // 点击模块任意位置选中模块
      module.onclick = function() {
        selectModule(moduleId);
      };
      
      // 删除模块事件
      module.querySelector('.delete-module').onclick = function(e) {
        e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
        removeModule(moduleId);
      };
      
      // 拖拽按钮点击事件
      module.querySelector('.module-drag').onclick = function(e) {
        e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
        selectModule(moduleId);
      };
      
      // 特定模块的事件
      switch(type) {
        case 'tasks':
          // 显示键盘按钮
          document.getElementById('show-keyboard-' + moduleId).onclick = function(e) {
            e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
            activeInput = document.getElementById('new-task-input-' + moduleId);
            showKeyboard();
          };
          
          // 任务输入框点击
          document.getElementById('new-task-input-' + moduleId).onclick = function(e) {
            e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
          };
          
          // 任务复选框事件
          var checkboxes = module.querySelectorAll('.task-checkbox');
          for (var i = 0; i < checkboxes.length; i++) {
            checkboxes[i].onchange = function() {
              var taskText = this.nextElementSibling;
              if (this.checked) {
                taskText.className += ' line-through text-gray-400';
              } else {
                taskText.className = taskText.className.replace(' line-through text-gray-400', '');
              }
            };
            checkboxes[i].onclick = function(e) {
              e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
            };
          }
          break;
          
        case 'notes':
          // 便签内容区点击
          var notesContent = document.getElementById('notes-content-' + moduleId);
          notesContent.onclick = function(e) {
            e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
            if (notesContent.textContent === '点击此处开始编辑便签...') {
              notesContent.textContent = '';
            }
          };
          
          // 显示键盘按钮
          document.getElementById('show-notes-keyboard-' + moduleId).onclick = function(e) {
            e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
            activeInput = notesContent;
            showKeyboard();
          };
          break;
          
        case 'calculator':
          // 计算器按钮事件
          var display = document.getElementById('calc-display-' + moduleId);
          var calcValue = '0';
          var lastOperator = '';
          var resetOnNextInput = false;
          
          var calcButtons = module.querySelectorAll('.calc-btn');
          for (var i = 0; i < calcButtons.length; i++) {
            calcButtons[i].onclick = function(e) {
              e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
              var value = this.getAttribute('data-value');
              
              // 数字和小数点
              if (/[0-9.]/.test(value)) {
                if (calcValue === '0' || resetOnNextInput) {
                  calcValue = value === '.' ? '0.' : value;
                  resetOnNextInput = false;
                } else {
                  // 防止多个小数点
                  if (value === '.' && calcValue.indexOf('.') !== -1) return;
                  calcValue += value;
                }
                display.textContent = calcValue;
              } 
              // 运算符
              else if (/[+*/-]/.test(value)) {
                if (lastOperator && !resetOnNextInput) {
                  // 计算当前结果
                  calculateResult(moduleId);
                }
                lastOperator = value;
                // 存储当前值
                var moduleIndex = addedModules.findIndex(function(m) { return m.id === moduleId; });
                if (moduleIndex !== -1) {
                  addedModules[moduleIndex].calcPrevValue = display.textContent;
                }
                resetOnNextInput = true;
              } 
              // 等于
              else if (value === '=') {
                calculateResult(moduleId);
                lastOperator = '';
              } 
              // 清除
              else if (value === 'C') {
                calcValue = '0';
                lastOperator = '';
                display.textContent = calcValue;
              } 
              // 退格
              else if (value === '←') {
                if (calcValue.length > 1) {
                  calcValue = calcValue.slice(0, -1);
                } else {
                  calcValue = '0';
                }
                display.textContent = calcValue;
              } 
              // 正负号
              else if (value === '+/-') {
                calcValue = (parseFloat(calcValue) * -1).toString();
                display.textContent = calcValue;
              } 
              // 百分比
              else if (value === '%') {
                calcValue = (parseFloat(calcValue) / 100).toString();
                display.textContent = calcValue;
              }
            };
          }
          break;
      }
    }

    // 选择模块
    function selectModule(moduleId) {
      // 先取消之前的选择
      deselectModule();
      
      var module = document.getElementById(moduleId);
      if (module) {
        module.className += ' module-selected z-30';
        selectedModule = moduleId;
      }
    }
    
    // 取消选择模块
    function deselectModule() {
      if (selectedModule) {
        var module = document.getElementById(selectedModule);
        if (module) {
          module.className = module.className.replace(' module-selected z-30', '');
        }
        selectedModule = null;
      }
    }
    
    // 删除选中的模块
    function deleteSelectedModule() {
      if (selectedModule) {
        removeModule(selectedModule);
        selectedModule = null;
      }
    }
    
    // 移除模块
    function removeModule(moduleId) {
      var module = document.getElementById(moduleId);
      if (module) {
        module.style.opacity = '0';
        module.style.transform = 'translate(-50%, -50%) scale(0.8)';
        module.style.transition = 'all 0.3s ease';
        
        setTimeout(function() {
          module.remove();
          // 从已添加模块列表中移除
          var index = addedModules.findIndex(function(m) { return m.id === moduleId; });
          if (index !== -1) {
            addedModules.splice(index, 1);
          }
        }, 300);
      }
    }

    // 初始化模块功能
    function initModuleFunctions(moduleId, type) {
      switch(type) {
        case 'clock':
          // 初始化时钟并每秒更新
          updateClock(moduleId);
          setInterval(function() {
            updateClock(moduleId);
          }, 1000);
          break;
          
        case 'weather':
          // 初始化天气
          getWeather(moduleId);
          // 每小时更新一次天气
          setInterval(function() {
            getWeather(moduleId);
          }, 3600000);
          break;
      }
    }

    // 更新时钟
    function updateClock(moduleId) {
      var now = new Date();
      
      // 更新时间
      var hours = now.getHours().toString().padStart(2, '0');
      var minutes = now.getMinutes().toString().padStart(2, '0');
      var seconds = now.getSeconds().toString().padStart(2, '0');
      var currentTime = hours + ':' + minutes + ':' + seconds;
      
      // 更新日期
      var weekdays = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
      var weekday = weekdays[now.getDay()];
      var year = now.getFullYear();
      var month = now.getMonth() + 1;
      var day = now.getDate();
      var currentDate = weekday + ', ' + year + '年' + month + '月' + day + '日';
      
      // 更新显示
      document.getElementById('clock-display-' + moduleId).textContent = currentTime;
      document.getElementById('date-display-' + moduleId).textContent = currentDate;
    }

    // 获取天气信息 - 使用高德地图API
    function getWeather(moduleId) {
      // 首先尝试通过IP获取位置
      var xhr = new XMLHttpRequest();
      xhr.open('GET', 'https://ipapi.co/json/', true);
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
          try {
            var ipData = JSON.parse(xhr.responseText);
            var city = ipData.city || '北京';
            fetchWeatherData(city, moduleId);
          } catch (e) {
            console.error('解析IP数据失败', e);
            fetchWeatherData('北京', moduleId);
          }
        } else if (xhr.readyState === 4) {
          // IP获取失败，使用默认城市
          fetchWeatherData('北京', moduleId);
        }
      };
      xhr.send();
    }
    
    function fetchWeatherData(city, moduleId) {
      var key = 'f6000f9d06539e8e119b4f6429d5a6e'; // 高德地图API key
      var weatherUrl = 'https://restapi.amap.com/v3/weather/weatherInfo?city=' + encodeURIComponent(city) + '&key=' + key + '&extensions=all';
      
      var xhr = new XMLHttpRequest();
      xhr.open('GET', weatherUrl, true);
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
          try {
            var data = JSON.parse(xhr.responseText);
            if (data.status === '1' && data.lives && data.lives.length > 0) {
              var liveData = data.lives[0];
              var forecasts = data.forecasts && data.forecasts.length > 0 ? data.forecasts[0].casts : [];
              updateWeatherUI(liveData, forecasts, moduleId);
            } else {
              updateWeatherError(moduleId);
            }
          } catch (e) {
            console.error('解析天气数据失败', e);
            updateWeatherError(moduleId);
          }
        } else if (xhr.readyState === 4) {
          updateWeatherError(moduleId);
        }
      };
      xhr.send();
    }
    
    function updateWeatherUI(liveData, forecasts, moduleId) {
      // 更新基本天气信息
      document.getElementById('temperature-' + moduleId).textContent = liveData.temperature + '°C';
      document.getElementById('weather-desc-' + moduleId).textContent = liveData.weather;
      document.getElementById('weather-location-' + moduleId).textContent = liveData.city;
      document.getElementById('humidity-' + moduleId).textContent = '湿度: ' + liveData.humidity + '%';
      document.getElementById('wind-' + moduleId).textContent = '风速: ' + liveData.windpower + '级';
      
      // 更新天气图标
      updateWeatherIcon(liveData.weather, moduleId);
      
      // 创建温度图表
      createTemperatureChart(forecasts, moduleId);
    }
    
    function updateWeatherIcon(weatherDesc, moduleId) {
      var iconElement = document.getElementById('weather-icon-' + moduleId);
      var icon = '☀'; // 默认图标
      
      if (weatherDesc.includes('晴')) {
        icon = '☀';
      } else if (weatherDesc.includes('云') || weatherDesc.includes('阴')) {
        icon = '☁';
      } else if (weatherDesc.includes('雨')) {
        icon = '🌧';
      } else if (weatherDesc.includes('雪')) {
        icon = '❄';
      } else if (weatherDesc.includes('雷')) {
        icon = '⚡';
      } else if (weatherDesc.includes('雾') || weatherDesc.includes('霾')) {
        icon = '🌫';
      }
      
      iconElement.innerHTML = '<span>' + icon + '</span>';
    }
    
    function updateWeatherError(moduleId) {
      document.getElementById('temperature-' + moduleId).textContent = '--';
      document.getElementById('weather-desc-' + moduleId).textContent = '获取失败';
      document.getElementById('weather-location-' + moduleId).textContent = '请检查网络';
      document.getElementById('humidity-' + moduleId).textContent = '湿度: --%';
      document.getElementById('wind-' + moduleId).textContent = '风速: --级';
      document.getElementById('weather-icon-' + moduleId).innerHTML = '<span>?</span>';
    }
    
    function createTemperatureChart(forecasts, moduleId) {
      var ctx = document.getElementById('temperature-chart-' + moduleId).getContext('2d');
      
      // 提取未来几天的温度数据
      var labels = [];
      var highTemps = [];
      var lowTemps = [];
      
      for (var i = 0; i < forecasts.length && i < 5; i++) {
        var cast = forecasts[i];
        var date = new Date(cast.date);
        labels.push((date.getMonth() + 1) + '/' + date.getDate());
        highTemps.push(parseInt(cast.daytemp));
        lowTemps.push(parseInt(cast.nighttemp));
      }
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [
            {
              label: '最高温',
              data: highTemps,
              borderColor: '#E67E22',
              backgroundColor: 'rgba(230, 126, 34, 0.1)',
              tension: 0.4,
              fill: false,
              pointBackgroundColor: '#E67E22',
              pointRadius: 3
            },
            {
              label: '最低温',
              data: lowTemps,
              borderColor: '#3498DB',
              backgroundColor: 'rgba(52, 152, 219, 0.1)',
              tension: 0.4,
              fill: false,
              pointBackgroundColor: '#3498DB',
              pointRadius: 3
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          animation: {
            duration: 2000,
            easing: 'easeOutQuart'
          },
                    scales: {
            y: {
              beginAtZero: false,
              grid: {
                display: true,
                color: 'rgba(0, 0, 0, 0.05)'
              },
              ticks: {
                font: {
                  size: 10
                },
                stepSize: 5
              }
            },
            x: {
              grid: {
                display: false
              },
              ticks: {
                font: {
                  size: 10
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(255, 255, 255, 0.9)',
              titleColor: '#2C3E50',
              bodyColor: '#2C3E50',
              borderColor: 'rgba(0, 0, 0, 0.1)',
              borderWidth: 1,
              padding: 8,
              boxPadding: 4,
              usePointStyle: true,
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': ' + context.raw + '°C';
                }
              }
            }
          }
        }
      });
    }
    
    // 计算器计算结果
    function calculateResult(moduleId) {
      var moduleIndex = addedModules.findIndex(function(m) { return m.id === moduleId; });
      if (moduleIndex === -1) return;
      
      var prevValue = parseFloat(addedModules[moduleIndex].calcPrevValue);
      var currentValue = parseFloat(document.getElementById('calc-display-' + moduleId).textContent);
      var operator = addedModules[moduleIndex].lastOperator;
      var result = 0;
      
      switch(operator) {
        case '+':
          result = prevValue + currentValue;
          break;
        case '-':
          result = prevValue - currentValue;
          break;
        case '*':
          result = prevValue * currentValue;
          break;
        case '/':
          if (currentValue === 0) {
            document.getElementById('calc-display-' + moduleId).textContent = '错误';
            return;
          }
          result = prevValue / currentValue;
          break;
        default:
          return;
      }
      
      // 处理小数位数
      result = Math.round(result * 10000) / 10000;
      
      document.getElementById('calc-display-' + moduleId).textContent = result;
      addedModules[moduleIndex].calcPrevValue = result;
    }
    
    // 显示虚拟键盘
    function showKeyboard() {
      var keyboard = document.getElementById('virtual-keyboard');
      keyboard.className = keyboard.className.replace(' hidden', '');
      // 重置拼音状态
      currentPinyin = '';
      hidePinyinCandidates();
    }
    
    // 隐藏虚拟键盘
    function hideKeyboard() {
      var keyboard = document.getElementById('virtual-keyboard');
      if (keyboard.className.indexOf('hidden') === -1) {
        keyboard.className += ' hidden';
      }
      activeInput = null;
      // 重置拼音状态
      currentPinyin = '';
      hidePinyinCandidates();
    }
    
    // 绑定虚拟键盘事件
    function bindKeyboardEvents() {
      // 关闭键盘按钮
      document.getElementById('close-keyboard').onclick = hideKeyboard;
      
      // 键盘切换按钮（中/英）
      document.getElementById('switch-keyboard').onclick = function() {
        inputMethod = inputMethod === 'chinese' ? 'english' : 'chinese';
        this.textContent = inputMethod === 'chinese' ? '中/英' : '英/中';
        // 重置拼音状态
        currentPinyin = '';
        hidePinyinCandidates();
      };
      
      // 键盘按键事件
      var keys = document.querySelectorAll('.keyboard-key');
      for (var i = 0; i < keys.length; i++) {
        keys[i].onclick = function() {
          if (!activeInput) return;
          
          var key = this.getAttribute('data-key');
          
          // 处理特殊键
          if (key === 'del') {
            handleDeleteKey();
          } else if (key === 'shift') {
            isShiftActive = !isShiftActive;
            updateShiftState();
          } else if (key === 'space') {
            handleSpaceKey();
          } else if (key === 'enter') {
            handleEnterKey();
          } else {
            // 处理普通字符键
            handleCharacterKey(key);
          }
        };
      }
    }
    
    // 更新Shift状态
    function updateShiftState() {
      var shiftKey = document.querySelector('[data-key="shift"]');
      if (isShiftActive) {
        shiftKey.classList.add('bg-primary/20');
        shiftKey.classList.add('text-primary');
      } else {
        shiftKey.classList.remove('bg-primary/20');
        shiftKey.classList.remove('text-primary');
      }
    }
    
    // 处理删除键
    function handleDeleteKey() {
      if (currentPinyin) {
        // 如果有正在输入的拼音，先删除拼音
        currentPinyin = currentPinyin.slice(0, -1);
        if (currentPinyin) {
          showPinyinCandidates(currentPinyin);
        } else {
          hidePinyinCandidates();
        }
      } else if (activeInput.tagName === 'INPUT') {
        // 输入框删除最后一个字符
        activeInput.value = activeInput.value.slice(0, -1);
      } else if (activeInput.isContentEditable) {
        // 可编辑区域删除最后一个字符
        var text = activeInput.textContent;
        activeInput.textContent = text.slice(0, -1);
        // 移动光标到最后
        var range = document.createRange();
        var sel = window.getSelection();
        range.setStartAfter(activeInput.lastChild);
        range.collapse(true);
        sel.removeAllRanges();
        sel.addRange(range);
      }
    }
    
    // 处理空格键
    function handleSpaceKey() {
      if (currentPinyin && inputMethod === 'chinese') {
        // 中文输入法下，空格选择第一个候选字
        var candidates = document.querySelectorAll('#pinyin-candidates span');
        if (candidates.length > 0) {
          insertText(candidates[0].textContent);
          currentPinyin = '';
          hidePinyinCandidates();
        }
      } else {
        // 否则插入空格
        insertText(' ');
      }
    }
    
    // 处理回车键
    function handleEnterKey() {
      // 对于任务模块，回车键添加任务
      if (activeInput && activeInput.id && activeInput.id.startsWith('new-task-input-')) {
        var moduleId = activeInput.id.replace('new-task-input-', '');
        var taskText = activeInput.value.trim();
        if (taskText) {
          addNewTask(moduleId, taskText);
          activeInput.value = '';
        }
      }
      // 隐藏拼音候选
      currentPinyin = '';
      hidePinyinCandidates();
    }
    
    // 添加新任务
    function addNewTask(moduleId, taskText) {
      var taskList = document.getElementById('task-list-' + moduleId);
      if (!taskList) return;
      
      var taskItem = document.createElement('div');
      taskItem.className = 'task-item flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-50 animate__animated animate__fadeIn';
      taskItem.innerHTML = '\
        <input type="checkbox" class="task-checkbox w-4 h-4 rounded text-primary focus:ring-primary">\
        <span class="task-text flex-1 text-sm">' + taskText + '</span>';
      
      // 添加到列表顶部
      taskList.insertBefore(taskItem, taskList.firstChild);
      
      // 绑定复选框事件
      var checkbox = taskItem.querySelector('.task-checkbox');
      checkbox.onchange = function() {
        var textElement = this.nextElementSibling;
        if (this.checked) {
          textElement.className += ' line-through text-gray-400';
        } else {
          textElement.className = textElement.className.replace(' line-through text-gray-400', '');
        }
      };
      checkbox.onclick = function(e) {
        e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
      };
    }
    
    // 处理字符键
    function handleCharacterKey(key) {
      // 处理大小写
      var char = isShiftActive ? key.toUpperCase() : key.toLowerCase();
      
      // 如果是中文输入法，处理拼音
      if (inputMethod === 'chinese' && /[a-z]/i.test(char)) {
        currentPinyin += char.toLowerCase();
        showPinyinCandidates(currentPinyin);
        // 关闭shift状态
        if (isShiftActive) {
          isShiftActive = false;
          updateShiftState();
        }
      } else {
        // 直接输入字符
        insertText(char);
        // 关闭shift状态
        if (isShiftActive) {
          isShiftActive = false;
          updateShiftState();
        }
      }
    }
    
    // 插入文本到激活的输入区域
    function insertText(text) {
      if (!activeInput) return;
      
      if (activeInput.tagName === 'INPUT') {
        activeInput.value += text;
        activeInput.focus();
      } else if (activeInput.isContentEditable) {
        // 处理可编辑区域
        var selection = window.getSelection();
        var range = selection.getRangeAt(0);
        range.deleteContents();
        
        var textNode = document.createTextNode(text);
        range.insertNode(textNode);
        
        // 移动光标到插入的文本后面
        range.setStartAfter(textNode);
        range.setEndAfter(textNode);
        selection.removeAllRanges();
        selection.addRange(range);
      }
    }
    
    // 显示拼音候选字
    function showPinyinCandidates(pinyin) {
      var candidatesContainer = document.getElementById('pinyin-candidates');
      var candidates = pinyinDict[pinyin] || [];
      
      if (candidates.length === 0) {
        hidePinyinCandidates();
        return;
      }
      
      // 生成候选字HTML
      var html = '';
      for (var i = 0; i < candidates.length && i < 8; i++) {
        html += '<span data-index="' + i + '">' + candidates[i] + '</span>';
      }
      
      candidatesContainer.innerHTML = html;
      candidatesContainer.className = 'pinyin-candidate'; // 显示候选区
      
      // 绑定候选字点击事件
      var candidateSpans = candidatesContainer.querySelectorAll('span');
      for (var j = 0; j < candidateSpans.length; j++) {
        candidateSpans[j].onclick = function() {
          insertText(this.textContent);
          currentPinyin = '';
          hidePinyinCandidates();
        };
      }
    }
    
    // 隐藏拼音候选字
    function hidePinyinCandidates() {
      var candidatesContainer = document.getElementById('pinyin-candidates');
      candidatesContainer.className = 'pinyin-candidate hidden';
      candidatesContainer.innerHTML = '';
    }
    
    // 绑定摇杆控制事件
    function bindJoystickEvents() {
      var joystickButtons = document.querySelectorAll('#joystick [data-direction], #joystick [data-action]');
      for (var i = 0; i < joystickButtons.length; i++) {
        joystickButtons[i].onclick = function(e) {
          e.stopPropagation ? e.stopPropagation() : (e.cancelBubble = true);
          
          if (!selectedModule) return;
          
          var module = document.getElementById(selectedModule);
          if (!module) return;
          
          // 处理方向控制
          var direction = this.getAttribute('data-direction');
          if (direction) {
            moveModule(module, direction);
          }
          
          // 处理动作控制（缩放等）
          var action = this.getAttribute('data-action');
          if (action) {
            handleModuleAction(module, action);
          }
        };
      }
    }
    
    // 移动模块
    function moveModule(module, direction) {
      var currentLeft = parseFloat(module.style.left);
      var currentTop = parseFloat(module.style.top);
      var moveStep = 2; // 移动步长（百分比）
      
      switch(direction) {
        case 'up':
          module.style.top = Math.max(5, currentTop - moveStep) + '%';
          break;
        case 'down':
          module.style.top = Math.min(95, currentTop + moveStep) + '%';
          break;
        case 'left':
          module.style.left = Math.max(5, currentLeft - moveStep) + '%';
          break;
        case 'right':
          module.style.left = Math.min(95, currentLeft + moveStep) + '%';
          break;
        case 'up-left':
          module.style.top = Math.max(5, currentTop - moveStep) + '%';
          module.style.left = Math.max(5, currentLeft - moveStep) + '%';
          break;
        case 'up-right':
          module.style.top = Math.max(5, currentTop - moveStep) + '%';
          module.style.left = Math.min(95, currentLeft + moveStep) + '%';
          break;
        case 'down-left':
          module.style.top = Math.min(95, currentTop + moveStep) + '%';
          module.style.left = Math.max(5, currentLeft - moveStep) + '%';
          break;
        case 'down-right':
          module.style.top = Math.min(95, currentTop + moveStep) + '%';
          module.style.left = Math.min(95, currentLeft + moveStep) + '%';
          break;
      }
    }
    
    // 处理模块动作（缩放等）
    function handleModuleAction(module, action) {
      switch(action) {
        case 'zoom-in':
          // 放大模块
          var currentScale = parseFloat(module.getAttribute('data-scale'));
          var newScale = Math.min(1.5, currentScale + 0.1);
          module.setAttribute('data-scale', newScale);
          module.style.transform = 'translate(-50%, -50%) scale(' + newScale + ')';
          break;
        case 'zoom-out':
          // 缩小模块
          var currentScale = parseFloat(module.getAttribute('data-scale'));
          var newScale = Math.max(0.7, currentScale - 0.1);
          module.setAttribute('data-scale', newScale);
          module.style.transform = 'translate(-50%, -50%) scale(' + newScale + ')';
          break;
        case 'text-in':
          // 文字放大
          var currentTextScale = parseFloat(module.getAttribute('data-text-scale'));
          var newTextScale = Math.min(1.5, currentTextScale + 0.1);
          module.setAttribute('data-text-scale', newTextScale);
          module.style.fontSize = newTextScale + 'em';
          break;
        case 'text-out':
          // 文字缩小
          var currentTextScale = parseFloat(module.getAttribute('data-text-scale'));
          var newTextScale = Math.max(0.7, currentTextScale - 0.1);
          module.setAttribute('data-text-scale', newTextScale);
          module.style.fontSize = newTextScale + 'em';
          break;
      }
    }
    
    // 点击空白处取消选择和隐藏菜单
    document.addEventListener('click', function(e) {
      var target = e.target;
      // 检查是否点击了模块内部或添加模块按钮
      var isModule = target.closest('#modules-container > div') !== null;
      var isAddButton = target.closest('#add-module-btn') !== null;
      var isModuleMenu = target.closest('#module-menu') !== null;
      var isKeyboard = target.closest('#virtual-keyboard') !== null;
      var isJoystick = target.closest('#joystick') !== null;
      
      if (!isModule && !isAddButton && !isModuleMenu && !isKeyboard && !isJoystick) {
        deselectModule();
        toggleModuleMenu(); // 隐藏模块菜单
      }
    });
  </script>
</body>
</html>
